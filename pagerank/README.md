# [PageRank](https://zh.wikipedia.org/wiki/PageRank)
![PageRank卡通示意图](https://upload.wikimedia.org/wikipedia/commons/6/69/PageRank-hi-res.png)
## 算法原理
`PageRank`又称`PR`，本质上是一种以网页之间的超链接个数和质量作为主要因素粗略地分析网页的重要性的算法。其基本假设是：更重要的页面往往更多地被其他页面引用（或称其他页面中会更多地加入通向该页面的超链接）。其将从A页面到B页面的链接解释为“A页面给B页面投票”，并根据投票来源（甚至来源的来源，即链接到A页面的页面）和投票对象的等级来决定被投票页面的等级。一个页面的PR值由链向它的页面数（入链数量）的重要性（入链质量）通过递归求解得到，链入到某一个页面的超链接相当于对该页投一票。一个有较多链入的页面会有较高的等级，相反如果一个页面没有任何链入页面，那么它没有等级

+ 入链数量（某个网页被其他网页指向的数量）：如果一个页面节点接收到的其他网页指向的入链数量越多，那么这个页面越重要
+ 入链质量：指向页面A的入链质量不同，质量高的页面会通过链接向其他页面传递更多的权重。所以越是质量高的页面指向页面A，则页面A越重要


## `PR`值计算：
+ 初始值：每个页面设置相同的PR值，Google的`PageRank`算法给每个页面的PR初始值为1
+ 迭代计算：Google不断的重复计算每个页面的PR值。经过不断的重复计算，这些页面的PR值会趋向于稳定，达到收敛状态


![a.png](https://i.loli.net/2019/06/12/5d00ae29cc84675071.png)

如上图所示：
 
+ 每个页面的初始PR值是1，进行第一轮计算：<br/>
  1）对于A页面来说，C给它投票，因为C总共投票数为2，其中一个投给了A，而其他页面没有投票给A，所以A的PR值为$\frac{1}{2}$<br/>
  2）对于B页面来说，A投票$\frac{1}{2}$，C投票$\frac{1}{2}$，D投票$\frac{1}{2}$，所以B的PR值为$\frac{3}{2}$<br/>
  3）对于C页面来说，A投票0，B投票1，D投票$\frac{1}{2}$，所以C的PR值为$\frac{3}{2}$<br/>
  4）对于D页面来说，A投票$\frac{1}{2}$，B投票0，C投票0，所以D的PR值为$\frac{1}{2}$<br/>
  
+ 根据的第一轮计算的结果进行下一次迭代<br/>
  PR(A)：$\frac{3}{2}\times 0 + \frac{3}{2} \times \frac{1}{2} + \frac{1}{2} \times 0 = \frac{3}{4}$<br/>
  PR(B)：$\frac{1}{2}\times \frac{1}{2} + \frac{3}{2} \times \frac{1}{2} + \frac{1}{2} \times \frac{1}{2} = \frac{5}{4}$<br/>
  PR(C)：$\frac{1}{2}\times 0 + \frac{3}{2} \times 1 + \frac{1}{2} \times \frac{1}{2} = \frac{7}{4}$<br/>
  PR(D)：$\frac{1}{2}\times \frac{1}{2} + \frac{3}{2} \times 0 + \frac{1}{2} \times 0 = \frac{1}{4}$<br/>

随着页面的PR值的迭代计算，其PR值会趋于稳定。在具体企业应用中怎么样确定收敛标准呢？
+ 每个页面的PR值和上一次计算的PR相等（很难达到）
+ 设定一个差值指标（0.0001）。当所有页面和上一次计算的PR差值平均小于该标准时，则收敛
+ 设定一个百分比（99%），当99%的页面和上一次计算的PR相等
  
根据前面的计算PR的方法，那么如果一个网页只出不入：PR会为0，只入不出：PR会很高，但是站在互联网的角度，PR为0是不科学的，我们可以通过直接在地址栏输入某个网页的地址来访问该网页，这里忽略了这一点，只是认为没有别的网页的链接指向它，它的PR值就为0。而PR值很高的网页应该是一个质量很高的网页，那么它应该有一些出链，为其他页面做贡献。所以应该修正PageRank计算公式：增加阻尼系数（damping factor）d，一般取值$d=0.85$

完整PageRank计算公式为：
$$PR(p_i)=\frac{1-d}{N} + d\sum_{p_j\in{M(p_i)}}\frac{PR(p_j)}{L(p_j)}$$
其中：
+ d：阻尼系数
+ N：所有页面的数量
+ $M(p_i)$：指向页面 $p_i$ 的页面集合
+ $PR(p_j)$：页面 `j` 的PR值
+ $L(p_j)$：页面 $p_j$ 链出页面的数量